<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Aura-Men</title>


    <link
    href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.5/dist/sweetalert2.min.css"
    rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.5/dist/sweetalert2.all.min.js"></script>


    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/css/open-iconic-bootstrap.min.css" />
    <link rel="stylesheet" href="/css/animate.css" />

    <link rel="stylesheet" href="/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="/css/owl.theme.default.min.css" />
    <link rel="stylesheet" href="/css/magnific-popup.css" />
    <link rel="stylesheet" href="/css/aos.css" />

    <link rel="stylesheet" href="/css/ionicons.min.css" />

    <link rel="stylesheet" href="/css/bootstrap-datepicker.css" />
    <link rel="stylesheet" href="/css/jquery.timepicker.css" />

    <link rel="stylesheet" href="/css/flaticon.css" />
    <link rel="stylesheet" href="/css/icomoon.css" />
    <link rel="stylesheet" href="/css/style.css" />

    <style>
      .breadcrumb-wrap {
            background: var(--light-gray);
            padding: 15px 0;
            margin-bottom: 50px;
        }

        .breadcrumb {
            margin: 0;
            padding: 0;
            font-size: 14px;
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .breadcrumb span {
            margin: 0 10px;
            color: #666;
        }

      
.rating-container .stars {
  display: inline-block;
}

.star-group {
  display: flex;
  flex-direction: row-reverse;
  justify-content: flex-end;
}

.star-label {
  cursor: pointer;
  padding: 0 2px;
  color: #ddd;
}

.star-label:hover,
.star-label:hover ~ .star-label,
input[type="radio"]:checked ~ .star-label {
  color: #ffc107;
}

.review-item {
  background-color: #f8f9fa;
}

.text-warning {
  color: #ffc107;
}
#addCart{
  background-color: #ffc107;
}button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px; 
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background-color: #45a049;
    }

    </style>
  </head>
  <body class="goto-here">
	
    <div class="py-1 bg-black">
		
      <div class="container">
        <div
          class="row no-gutters d-flex align-items-start align-items-center px-md-0"
        >
          <div class="col-lg-12 d-block">
            <div class="row d-flex">
              <div class="col-md pr-4 d-flex topper align-items-center">
                <div
                  class="icon mr-2 d-flex justify-content-center align-items-center"
                >
                  <span class="icon-phone2"></span>
                </div>
                <span class="text">+91 8590613068</span>
              </div>
              <div class="col-md pr-4 d-flex topper align-items-center">
                <div
                  class="icon mr-2 d-flex justify-content-center align-items-center"
                >
                  <span class="icon-paper-plane"></span>
                </div>
                <span class="text">aurastore@email.com</span>
              </div>
              <div
                class="col-md-5 pr-4 d-flex topper align-items-center text-lg-right"
              >
                <span class="text"
                  >3-5 Business days delivery &amp; Free Returns</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%-include('../partials/user/header')%>
    <!-- END nav -->

    <div
      class="hero-wrap hero-bread"
      style="background-image: url('/images/product-deailsbanner.webp')"
    >
      <div class="container">
        <div
          class="row no-gutters slider-text align-items-center justify-content-center"
        >
          <div class="col-md-9 ftco-animate text-center">
            <!-- <p class="breadcrumbs">
              <span class="mr-2"><a href="index.html">Home</a></span>
              <span>Shop</span>
            </p> -->
            <h1 class="mb-0 bread" style="color: white;">Product Details</h1>
          </div>
        </div>
      </div>
    </div>

    <section class="ftco-section">
      <div class="container">
        <div class="breadcrumbs" style="margin-top: -40px;">
          <a href="/">Home</a>
          <span>></span>
          <a href="/shopping">Shop</a>
          <span>>></span> 
          <a href="/product-details">Product Details</a>   
        </div>
        <div class="row">
			<div class="col-lg-5 mb-3 ftco-animate">
				<div class="main-image-container" style="position: relative; overflow: hidden;">
				  <img
					id="mainImage"
					class="img-fluid"
					src="/uploads/<%= product.productImage[0] %>"
					alt="<%= product.productName %>"
					style="width: 100%; max-height: 400px; object-fit: cover; transition: transform 0.3s ease;" 
					onmousemove="zoomImage(this, event)" 
					onmouseout="resetImage(this)"
				  />
				</div>
				
				<!-- Thumbnail Images -->
				<div class="mt-3 d-flex">
				  <% for (let i = 0; i < product.productImage.length; i++) { %>
				  <img
					class="img-thumbnail me-2"
					src="/uploads/<%= product.productImage[i] %>"
					alt="<%= product.productName %>"
					style="width: 100px; height: 100px; object-fit: cover; cursor: pointer;"
					onclick="changeMainImage('/uploads/<%= product.productImage[i] %>')"
				  />
				  <% } %>
				</div>
			  </div>
			  
			  			  
          <div class="col-lg-6 product-details pl-md-5 ftco-animate">
            <form action="/addToCart/<%= product._id %>" method="post">
              <h3><%= product.productName %></h3>
              <div class="rating d-flex">
                <p class="text-left mr-4">
                  <a href="#" class="mr-2">5.0</a>
                  <a href="#"><span class="ion-ios-star-outline"></span></a>
                  <a href="#"><span class="ion-ios-star-outline"></span></a>
                  <a href="#"><span class="ion-ios-star-outline"></span></a>
                  <a href="#"><span class="ion-ios-star-outline"></span></a>
                  <a href="#"><span class="ion-ios-star-outline"></span></a>
                </p>
                <p class="text-left mr-4">
                  <a href="#" class="mr-2" style="color: #000">100 <span style="color: #bbb">Rating</span></a>
                </p>
                <p class="text-left">
                  <a href="#" class="mr-2" style="color: #000">500 <span style="color: #bbb">Sold</span></a>
                </p>
              </div>
              <% if (offer) { %>
                <% if (product.regularPrice > offer.minPrice && product.regularPrice < offer.maxPrice) { %>
                  <p class="price">
                    <span><del>Price: <%= product.regularPrice %></del></span>
                    <span style="color: red;">
                      Offer: <%= product.regularPrice - ((product.regularPrice * offer.offer) / 100)-product.productOffer %>
                    </span>
                  </p>
                <% } else { %>
                  <p class="price"><span>Price: <%= product.regularPrice %></span></p>
                <% } %>
              <% } else if(product.productOffer) { %>
                <p class="price">
                  <span><del>Price: <%= product.regularPrice %></del></span>
                  <span style="color: red;">
                    Offer: <%= product.regularPrice - product.productOffer %>
                  </span>
                </p>
              <% }else{ %>
                <p class="price"><span>Price: <%= product.regularPrice %></span></p>
                <% } %>
              <div class="row mt-4">
                <div class="col-md-6">
                  <div class="form-group d-flex">
                    <div class="select-wrap">
                      <div class="icon">
                        <span class="ion-ios-arrow-down"></span>
                      </div>
                      <select name="size" id="size" class="form-control" data-sizes="<%= JSON.stringify(product.size) %>">
                        <% Object.entries(product.size).forEach(([key, value]) => { %>
                          <option value="<%= key %>"><%= key %> quantity: <%= value %></option>
                        <% }); %>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="w-100"></div>
                <div class="input-group col-md-6 d-flex mb-3">
                  <span class="input-group-btn mr-2">
                    <button id="decrease" type="button" class="quantity-left-minus btn" data-type="minus" data-field="">
                      <i class="ion-ios-remove"></i>
                    </button>
                  </span>
                  <input type="number" id="quantity" name="quantity" class="quantity form-control input-number" min="1"  />
                  <span class="input-group-btn ml-2">
                    <button id="increase" type="button" class="quantity-right-plus btn" data-type="plus" data-field="">
                      <i class="ion-ios-add"></i>
                    </button>
                  </span>
                </div>
                <% if(msg.length>0){ %>

                  <h6 class="text-danger text-center"><%=msg%></h6>
                <%}%>
                <div class="w-100"></div>
                <div class="col-md-12">
                  <% if (product.quantity && product.quantity > 0) { %>
                    <p style="color: red">Stock Left:<%= product.quantity %></p>
                  <% } else { %>
                    <p style="color: red">Out Of Stock</p>
                  <% } %>
                </div>
              </div>
              <a href="" class="btn btn-primary">
                <button type="submit" id="addCart" class="btn btn-primary">Add to Cart</button>
              </a>
              <a href="" class="btn btn-primary">
                <button type="submit" id="addWishlist" class="btn btn-primary" onclick="addToWishlist('<%= product._id %>',event)">WishList</button>
            </a>
            </form>                      
          </div>
        </div>

        <div class="row mt-5">
          <div class="col-md-12 nav-link-wrap">
            <div
              class="nav nav-pills d-flex text-center"
              id="v-pills-tab"
              role="tablist"
              aria-orientation="vertical"
            >
              <a
                class="nav-link ftco-animate active mr-lg-1"
                id="v-pills-1-tab"
                data-toggle="pill"
                href="#v-pills-1"
                role="tab"
                aria-controls="v-pills-1"
                aria-selected="true"
                >Description</a
              >
<!-- 
                <a
                  class="nav-link ftco-animate mr-lg-1"
                  id="v-pills-2-tab"
                  data-toggle="pill"
                  href="#v-pills-2"
                  role="tab"
                  aria-controls="v-pills-2"
                  aria-selected="false"
                  >Manufacturer</a
                > -->

              <a
                class="nav-link ftco-animate"
                id="v-pills-3-tab"
                data-toggle="pill"
                href="#v-pills-3"
                role="tab"
                aria-controls="v-pills-3"
                aria-selected="false"
                >Reviews</a
              >
            </div>
          </div>
          <div class="col-md-12 tab-wrap">
            <div class="tab-content bg-light" id="v-pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="v-pills-1"
                role="tabpanel"
                aria-labelledby="day-1-tab"
              >
                <div class="p-4">
                  <h3 class="mb-4"><%= product.productName%></h3>
                 <p>
                  <%= product.description%>
                 </p>
                </div>
              </div>

              <!-- <div
                class="tab-pane fade"
                id="v-pills-2"
                role="tabpanel"
                aria-labelledby="v-pills-day-2-tab"
              >
                <div class="p-4">
                  <h3 class="mb-4">Manufactured By Nike</h3>
                  <p>
                    On her way she met a copy. The copy warned the Little Blind
                    Text, that where it came from it would have been rewritten a
                    thousand times and everything that was left from its origin
                    would be the word "and" and the Little Blind Text should
                    turn around and return to its own, safe country. But nothing
                    the copy said could convince her and so it didn’t take long
                    until a few insidious Copy Writers ambushed her, made her
                    drunk with Longe and Parole and dragged her into their
                    agency, where they abused her for their.
                  </p>
                </div>
              </div> -->
              <!-- review -->
              <div class="tab-pane fade" id="v-pills-3" role="tabpanel" aria-labelledby="v-pills-3-tab">
                <div class="p-4">
                  <h3 class="mb-4">Reviews</h3>
                  
                  <!-- Review Form -->
                  <div class="review-form mb-5">
                    <h4 class="mb-3">Write a Review</h4>
                    <form action="/review/<%= product._id %>" method="post" id="reviewForm">
                      <input type="hidden" name="productId" value="<%= product._id %>">
                      <!-- Star Rating -->
                      <div class="rating-container mb-3">
                        <div class="stars">
                          <div class="star-label mb-2">Your Rating:</div>
                          <div class="star-group">
                            <% for (let i=5;i>=1;i--) { %>
                              <input 
                                  type="radio" 
                                  id="star<%= i %>" 
                                  name="rating" 
                                  value="<%= i %>" 
                                  class="d-none" 
                              />
                              <label for="star<%= i %>" class="star-label">
                                  ★
                              </label>
                          <% } %>
                          </div>
                        </div>
                      </div>
              
                      <!-- Review Text -->
                      <div class="form-group mb-3">
                        <label for="reviewText">Your Review:</label>
                        <textarea 
                          class="form-control" 
                          id="reviewText" 
                          name="comment" 
                          rows="4" 
                          required
                          placeholder="Share your experience with this product..."
                        ></textarea>
                      </div>
              
                      <!-- Submit Button -->
                      <button type="submit" class="btn btn-primary">Submit Review</button>
                    </form>
                  </div>
              
                  <!-- Display Reviews -->
                  <div class="reviews-container">
                    <h4 class="mb-4">Customer Reviews</h4>
                    <% product.reviews.forEach(review => { %>
                      <div class="review-item mb-4 p-3 border rounded">
                          <div class="review-header d-flex justify-content-between align-items-center mb-2">
                              <div class="rating">
                                  <% for (let i = 1; i <= 5; i++) { %>
                                      <i class="bi <%= i <= review.rating ? 'bi-star-fill' : 'bi-star' %> text-warning"></i>
                                  <% } %>
                              </div>
                              <small class="text-muted"><%= review.userId ? review.userId.name : "Unknown User" %> - <%= new Date(review.date).toLocaleDateString() %></small>
                          </div>
                          <div class="review-content">
                              <p class="mb-1"><%= review.comment %></p>
                          </div>
                      </div>
                    <% }); %>                    
                      <p>No reviews yet. Be the first to review this product!</p>
                  </div>
                </div>
              </div>
              <div>
                <h3>Other</h3>
                <div class="row">
                <% for(let i=0;i<ranNum.length;i++){ %>
                  <div class="col-sm-12 col-md-4 ftco-animate d-flex">
                    <div class="product d-flex flex-column">
                      <a href="/product-details/<%=allProduct[i]._id %>" class="img-prod">
                        <img
                  class="img-fluid"
                  src="/uploads/<%= allProduct[i].productImage[0] %>"
                  alt="<%= allProduct[i].productName %>"
                      />
                        <div class="overlay"></div>
                      </a>
                      <div class="text py-3 pb-4 px-3">
                        <div class="d-flex">
                          <div class="cat">
                            <span></span>
                          </div>
                         
                        </div>
                        <h3><a href="#"><%= allProduct[i].productName %></a></h3>
                        <div class="pricing">
                          <% if(offer){ %>
                            <% if(allProduct[i].regularPrice>offer.minPrice && allProduct[i].regularPrice<offer.maxPrice){ %>
                                <p class="price">
                                    <span><del>Price ₹: <%= allProduct[i].regularPrice %></del></span>
                                    <span style="color: red;">
                                      Offer ₹:<%= allProduct[i].regularPrice - ((allProduct[i].regularPrice * offer.offer) / 100) %>
                                    </span>
                                </p>
                            <% }else{ %>
                                <p class="price"><span>Price ₹: <%=allProduct[i].regularPrice%></span></p>
                            <% } %>
                        <% }else if(allProduct[i].productOffer){ %>
                          <p class="price">
                            <span><del>Price ₹:<%= allProduct[i].regularPrice %></del></span>
                            <span style="color: red;">
                              Offer ₹:<%= allProduct[i].regularPrice - allProduct[i].productOffer %>
                            </span>
                        </p>
                        <% }else{ %>
                          <p class="price"><span>Price: <%= allProduct[i].regularPrice %></span></p>
                          <% } %>
                        </div>
                        <p class="bottom-area d-flex px-3">
                          <a href="#" class="add-to-cart text-center py-2 mr-1"><span>Add to cart <i class="ion-ios-add ml-1"></i></span></a>
                          <a href="#" class="buy-now text-center py-2">Buy now<span><i class="ion-ios-cart ml-1"></i></span></a>
                        </p>
                      </div>
                    </div>
                  </div>
                <% } %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <%-include('../partials/user/footer')%>
    <!-- loader -->
    <div id="ftco-loader" class="show fullscreen">
      <svg class="circular" width="48px" height="48px">
        <circle
          class="path-bg"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke="#eeeeee"
        />
        <circle
          class="path"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke-miterlimit="10"
          stroke="#F96D00"
        />
      </svg>
    </div>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery-migrate-3.0.1.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/jquery.easing.1.3.js"></script>
    <script src="/js/jquery.waypoints.min.js"></script>
    <script src="/js/jquery.stellar.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/jquery.magnific-popup.min.js"></script>
    <script src="/js/aos.js"></script>
    <script src="/js/jquery.animateNumber.min.js"></script>
    <script src="/js/bootstrap-datepicker.js"></script>
    <script src="/js/scrollax.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
    <script src="/js/google-map.js"></script>
    <script src="/js/main.js"></script>

    <script>

	</script>
      

	 <script>

function zoomImage(imageElement, event) {
  const rect = imageElement.getBoundingClientRect();


  const x = event.clientX - rect.left; 
  const y = event.clientY - rect.top;  

  const xPercent = (x / rect.width) * 100; 
  const yPercent = (y / rect.height) * 100; 

  
  imageElement.style.transformOrigin = `${xPercent}% ${yPercent}%`;
  imageElement.style.transform = "scale(2.0)"; 
  imageElement.style.cursor = "zoom-in";
}

function resetImage(imageElement) {
  
  imageElement.style.transform = "scale(1)";
  imageElement.style.transformOrigin = "center center";
}


		function changeMainImage(imageSrc) {
		  document.getElementById("mainImage").src = imageSrc;
		}

    const sizeData=JSON.parse(document.getElementById('size').getAttribute('data-sizes'))
    
document.getElementById('size').addEventListener('change', ()=>{
  document.getElementById('quantity').value=1
})
document.getElementById('quantity').value = 1
document.getElementById('increase').addEventListener('click', ()=>{
  const size=document.getElementById('size').value
  const value=parseInt(document.getElementById('quantity').value)
  if(value>4){
    return
  }else if(value>sizeData[size]-1){
    return
  }
    
  document.getElementById('quantity').value=value+1
})

document.getElementById('decrease').addEventListener('click', ()=>{
  const value=parseInt(document.getElementById('quantity').value)
  if(value==1){
    return
  }
    
  document.getElementById('quantity').value=value-1
})
   
const addToWishlist = async (productId,e) => {
  e.preventDefault()
  console.log('Product ID is', productId);

  try {
    const response = await fetch('/addToWishlist', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json', 
      },
      body: JSON.stringify({ productId }), 
    });

    const result = await response.json();

    if (result.success) {
      swal.fire({
        title: 'Success',
        text: result.message,
        icon: 'success',
      })
    } else {
      swal.fire({
        title: 'Error',
        text: result.message,
        icon: 'error',
      }).then(()=>{
				if(result.redirectUrl){
				window.location.href = result.redirectUrl
				}
			})
    }
  } catch (error) {
    console.error('Error adding to wishlist:', error);
    swal.fire({
      title: 'Error',
      text: 'An error occurred while adding to wishlist',
      icon: 'error',
    });
  }
};



    
	  </script>
  </body>
</html>
